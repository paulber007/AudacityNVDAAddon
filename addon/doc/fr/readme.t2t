Module complémentaire pour Audacity - manuel utilisateur
auteur: paulber19 (paulber19@laposte.net)
Dernière modification: %%date(%d/%m/%Y)

%!Target: html
%!Encoding: UTF-8
%!Options: --toc
%!style:..\style.css
% Remove the Table of Contents heading from the toc.
%!PostProc(html): '^.*\<LI\>\<A HREF="#toc"\>.*\</A\>.*$' ''

% h1 in html should really be the document title only.
% Therefore, change h1 through h5 in the output to h2 through h6.
%!PostProc(html): ^<H5>(.*)</H5>$ <H6>\1</H6>
%!PostProc(html): ^<H4>(.*)</H4>$ <H5>\1</H5>
%!PostProc(html): ^<H3>(.*)</H3>$ <H4>\1</H4>
%!PostProc(html): ^<H2>(.*)</H2>$ <H3>\1</H3>
%!PostProc(html): ^<H1>(.*)</H1>$ <H2>\1</H2>
% key definition
%!PostProc (html): KEY_AUDIO_POSITION Control+shift+t
%!PostProc (html): KEY_SELECTION Control+shift+s
%!PostProc (html): KEY_BUTTONS_STATE Control+Alt+f5

= Sommaire =[toc]
%%toc

+ Introduction +

++ Fonctionnalités ++
Ce module complémentaire  apporte:

- [un script pour annoncer la position du curseur audio #HDR1],
- [un script pour annoncer le début et la fin de sélection #HDR2], 
- [un script pour connaître l'état des boutons "Lecture" et "Pause" #HDR3],
- [l'annonce automatique de la position audio #HDR4],
- [l'annonce automatique de la sélection #HDR5],
- [l'utilisation possible de la barre d'espace pour appuyer sur un bouton #HDR6],
- [amélioration des zone d'édition d'un temps de la barre d'outils Sélection Audacity  #HDR7].


++ Compatibilité ++
Ce module a été testé, avec NVDA 2017.2 et   la version 2.1.3 d'audacity. Il reste en principe compatible avec les versions 2.03, 2.05 et  2.06  d'Audacity.


++ Configuration à respecter ++
Pour un bon fonctionnement du module, il est nécessaire de :

- laisser affichées Toutes les barres d'outils, en particulier la barre d'outils Sélection Audacity.
- Conserver le format  d'affichage du temps défini par défaut ou choisir  parmi un des formats indiqués au chapitre [Vocalisation des zones d'édition du temps dans la boite d'outils Sélection Audacity #HDR7]


+ Script d'annonce de la position audio +[hdr1]
Pour utiliser ce script, il faut que le focus soit dans la vue de piste.
Ce script se lance par la commande clavier "KEY_AUDIO_POSITION".
Il annonce  le temps indiqué dans le champ "position audio" de la barre d'outils  "Sélection".


+ Script d'annonce de la sélection +[hdr2]
Pour utiliser ce script, il faut que le focus soit dans la vue de piste.
Ce script se lance par la commande clavier "KEY_SELECTION.
Il annonce le temps indiqué dans les champs suivants de la barre d'outils "Sélection": 
- champ "Début de sélection",
- champ "fin de sélection" si le choix "fin" est sélectionné,
- champ "Longueur de la sélection" si le choix "durée" est sélectionné.


Si les deux temps sont nuls, "aucune sélection" est annoncée.

+ Script d'annonce de l'état des boutons Pause et Lecture +[hdr3]
Pour utiliser ce script, il faut que le focus se trouve dans la vue de piste.
Il se lance par la commande clavier KEY_BUTTONS_STATE
Il annonce l'état  des boutons "Lecture" et "Pause".
Si le bouton "lecture" n'est pas enfoncé, "lecture arrêtée" est annoncé.

+ Annonce automatique de la position audio +[hdr4]
En lecture audio ou non, les raccourcis suivants d'Audacity (définis par défaut) permettent de définir ou de déplacer le curseur audio:
- "Majuscule + a"ou "x": lecture / stop  et positionnement du curseur audio
- "flèche gauche": petit saut à gauche,
- "flèche droite": petit saut à droite,
- "début": saut au début,
- "fin": saut à la fin,
- ",": petit saut à gauche,
- ".": petit saut à droite,
- "Majuscule + ,": grand saut à gauche,
- "Majuscule + .": grand saut à droite,
- "espace": lecture /stop


En lecture audio arrêtée et après l'activation du raccourci, le champ "position audio" de la barre d'outils "Sélection" est automatiquement annoncé  si un changement a eu lieu et sous la forme:
- annonce du label du champ("position audio",
- annonce du contenu du champ formaté pour ne pas dire les zéros.


Le retour de la position audio en début de sélection est signalé.
Ces raccourcis peuvent être modifiés par l'utilisateur sans impacter ce fonctionnement.


+ Annonce automatique de la sélection +[hdr5]
Les raccourcis suivants d'Audacity (définis par défaut) permettent de définir ou de déplacer le début et la fin de la sélection:
- "Majuscule + début": sélection jusqu'au début,
- "Majuscule + fin": sélection jusqu'à la fin,
- "Majuscule + j": sélection du début de la piste jusqu'au curseur,
- "Majuscule + k": sélection du curseur jusqu'à la fin de la piste
- "Majuscule + flèche gauche": étendre la sélection à gauche , 
- "Control + Majuscule + flèche droite": réduire la sélection à droite 
- Majuscule + flèche droite": étendre la sélection à droite,
- "Control + Majuscule + flèche gauche": réduire la sélection à gauche


En lecture arrêtée et après l'activation du raccourci et si un changement a eu lieu, suivant le type de raccourci, l'un  ou l'autre ou les deux des champs de sélection de la barre d'outils "Sélection" est annoncé sous la forme:

- annonce du label du champ,
- annonce de son contenu formaté pour ne pas dire les zéros.


Le second champ de sélection indique, suivant le choix "durée" ou"fin":
- soit la durée de la sélection,
- soit le temps auquel se trouve la fin de la sélection.


Comme Tous les labels annoncés sont ceux qui sont affichés par Audacity, il peut y avoir des incohérences dues à la traduction  ou au codage (par exemple, sélection fin au lieu de fin de la sélection", "durée sélection" au lieu de "longueur de la sélection").

Ces raccourcis  peuvent être modifiés par l'utilisateur sans impacter ce fonctionnement.

La commande clavier propre au module "alt+control+f4" permet d'activer ou désactiver cette annonce des changements de sélection quand celle-ci devient gênante.

+ Appui sur un bouton avec la barre d'espace +[HDR6]
Dans Audacity, la barre d'espace est prévue pour lancer ou arrêter la lecture audio, mais pas pour appuyer sur un bouton.
Pour appuyer sur le bouton, il faut utiliser la touche "Entrée" mais cela déplace le focus sur l'élément suivant de la fenêtre.
Le module permet l'utilisation de la barre d'espace pour appuyer sur un bouton.
Mais dans ce cas, la lecture audio ne peut plus être lancer tant que le focus est sur un bouton autre que "Lecture" ou "Pause".


+ Vocalisation des zones d'édition du temps dans la boite d'outils Sélection Audacity +[HDR7]

La Barre d'outils Sélection Audacity  présente les zones d'édition suivantes:
- début de la sélection,
- durée ou fin de la sélection,
- position audio.


Ces zones contiennent un temps qui peut être modifier.
Ce temps est inscrit suivant un format que l'on configure avec le menu contextuel.
Pour modifier ce temps, il faut se placer sur le chiffre à modifier  (par flèche droite ou gauche)  et l'augmenter ou le diminuer avec les flèches haute ou bas.
Ce module permet une meilleure vocalisation d'une part  en indiquant le temps en heure, minute et secondes et d'autre part, en   indiquant la nature du chiffre qui est modifié:

-  les dizaines et les unités pour les heures, les minutes et les secondes,
-  les dixièmes, centièmes et les  millièmes pour les secondes.


Mais seules les format suivants sont pris en compte:

- HH:MM:SS,
- HH:MM:SS,centième
- HH:MM:SS,millième





+ Historique +
++ v2.3 (3 Août 2017) ++
- script "alt+control+f4" pour activer ou désactiver l'annonce des changements de sélection,
- compatibilité avec audacity v2.1.3,
- reprise du code.


++ v2.2 (11 Juin 2015) ++
- restructuration du code


++ v2.1 (7 Octobre 2014) ++

- compatibilité avec NVDA 2014.3
- compatibilité avec Audacity v2.06


++ v2.0 (8 mai 2014) ++
- mise en place d'une surveillance des champ position et sélection pour annoncer les changements.


++ v1.0 (24 janvier 2014) ++
Création du module complémentaire 
